<!-- src/app/components/risk-gauge/risk-gauge.component.html -->

<div class="gauge-container">
    <!-- SVG Gauge -->
    <div class="gauge">
        <svg viewBox="0 0 200 120" class="gauge-svg">
            <!-- Gradient Definition -->
            <defs>
                <linearGradient [attr.id]="getGradientId()" x1="0%" y1="0%" x2="100%" y2="0%">
                    <stop offset="0%" [attr.stop-color]="colorStart" />
                    <stop offset="100%" [attr.stop-color]="colorEnd" />
                </linearGradient>

                <!-- Glow filter -->
                <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
                    <feGaussianBlur stdDeviation="3" result="coloredBlur" />
                    <feMerge>
                        <feMergeNode in="coloredBlur" />
                        <feMergeNode in="SourceGraphic" />
                    </feMerge>
                </filter>
            </defs>

            <!-- Background Arc -->
            <path d="M 20 100 A 80 80 0 0 1 180 100" fill="none" stroke="#334155" stroke-width="16"
                stroke-linecap="round" class="gauge-bg" />

            <!-- Tick marks -->
            <g class="tick-marks">
                <line x1="20" y1="100" x2="30" y2="100" stroke="#475569" stroke-width="2" />
                <line x1="37" y1="55" x2="45" y2="60" stroke="#475569" stroke-width="2" />
                <line x1="100" y1="20" x2="100" y2="30" stroke="#475569" stroke-width="2" />
                <line x1="163" y1="55" x2="155" y2="60" stroke="#475569" stroke-width="2" />
                <line x1="180" y1="100" x2="170" y2="100" stroke="#475569" stroke-width="2" />
            </g>

            <!-- Labels -->
            <text x="20" y="120" class="gauge-label" fill="#64748b">0</text>
            <text x="95" y="5" class="gauge-label" fill="#64748b">50</text>
            <text x="172" y="120" class="gauge-label" fill="#64748b">100</text>

            <!-- Colored Progress Arc -->
            <path d="M 20 100 A 80 80 0 0 1 180 100" fill="none" [attr.stroke]="getGradientUrl()" stroke-width="16"
                stroke-linecap="round" [style.stroke-dasharray]="arcLength" [style.stroke-dashoffset]="dashOffset"
                class="gauge-fill" filter="url(#glow)" />
        </svg>

        <!-- Center Score Display -->
        <div class="gauge-center">
            <div class="score" [style.color]="scoreColor">
                {{ displayScore }}
            </div>
            <div class="score-label">Risk Score</div>
        </div>
    </div>

    <!-- Risk Level Badge -->
    <div class="risk-badge" [ngClass]="bgClass">
        <span class="badge-icon">{{ levelIcon }}</span>
        <span class="badge-text">{{ riskLevel }} RISK</span>
    </div>

    <!-- Risk Message -->
    <div class="risk-message" [ngClass]="bgClass">
        {{ riskMessage }}
    </div>

    <!-- Analysis Time -->
    <div class="analysis-time" *ngIf="analysisTime > 0">
        <span class="time-icon">⏱️</span>
        <span>Analyzed in {{ analysisTime | number:'1.0-0' }}ms</span>
    </div>
</div>